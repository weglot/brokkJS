/*! BrokkJS 2019-02-05 */

!function(s,t,n,e){var r="brokkJS";function i(i,t){this.element=i,this._name=r,this._defaults=s.fn.brokk.defaults;var o={};s.each(this._defaults,function(t,e){if("function"!=typeof e){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"this"===(e=s(i).attr("data-brokk-"+n))&&(e=i),"requestParams"===t&&void 0!==e&&(e=JSON.parse(e)),o[t]=e}}),void 0!==o.params&&(o.params=JSON.parse(o.params)),this.options=s.extend({},this._defaults,o),this.options=s.extend({},this.options,t),this.init()}s.extend(i.prototype,{init:function(){this.buildCache(),this.bindEvents()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildCache:function(){this.$element=s(this.element)},bindEvents:function(){var e=this;switch(this.options.fireEvent){case s.fn.brokk.fireEvents.ON_READY:s(n).ready(function(){e.fire()});break;case s.fn.brokk.fireEvents.ON_CLICK:e.$element.on("click."+e._name,function(){e.fire()});break;case s.fn.brokk.fireEvents.ON_SUBMIT:e.$element.on("submit."+e._name,function(t){s(this)[0].checkValidity()&&(t.preventDefault(),e.fire())})}},unbindEvents:function(){this.$element.off("."+this._name)},callback:function(t,arguments){"function"==typeof t&&t.call(this,arguments)},fire:function(){var e=this;this.callback(this.options.before),s.ajax({url:this.options.requestUrl,type:this.options.requestMethod,dataType:"json",data:this.options.requestParams,success:function(t){e.callback(e.options.onSuccess,{data:t})},error:function(t){e.callback(e.options.onError,{xhr:t})}}).always(function(){e.callback(e.options.onComplete)})},fireSuccessElements:function(arguments){var t=this.options.toFireSuccessElements;s(t).data("plugin_"+r)&&s(t).brokkApi().fire()},before:function(arguments){s(this.options.triggerElements).prop("disabled",!0),s(this.options.triggerElements).addClass("disabled"),this.options.showOverLay&&0===s(this.options.toUpdateElements).find("#brokk-loading").length&&s(this.options.toUpdateElements).append('<span id="brokk-loading">'+s.fn.brokk.loadingTemplate+"</span>")},onSuccess:function(arguments){s(this.options.toUpdateElements).html(arguments.data),this.fireSuccessElements()},onError:function(arguments){},onComplete:function(arguments){s(this.options.triggerElements).prop("disabled",!1),s(this.options.triggerElements).removeClass("disabled"),s(this.options.toUpdateElements).find("#brokk-loading").remove()}}),s.fn.brokk=function(t){return this.each(function(){s.data(this,"plugin_"+r)||s.data(this,"plugin_"+r,new i(this,t))})},s.fn.brokkApi=function(){return s.data(this[0],"plugin_"+r)},s.fn.brokk.loadingTemplate="Loading",s.fn.brokk.fireEvents={ON_READY:"onReady",ON_CLICK:"onClick",ON_SUBMIT:"onSubmit"},s.fn.brokk.defaults={requestUrl:null,requestMethod:"GET",requestParams:null,fireEvent:s.fn.brokk.fireEvents.ON_READY,toUpdateElements:null,triggerElements:null,toFireSuccessElements:null,showOverLay:!0,before:function(arguments){this.before(arguments)},onSuccess:function(arguments){this.onSuccess(arguments)},onError:function(arguments){this.onError(arguments)},onComplete:function(arguments){this.onComplete(arguments)}}}(jQuery,window,document);